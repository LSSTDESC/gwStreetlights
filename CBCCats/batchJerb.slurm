#!/bin/bash

# Base script generated by NERSC Batch Script Generator on https://iris.nersc.gov/jobscript.html

#SBATCH -N 1
#SBATCH -C cpu
#SBATCH -q regular
#SBATCH -J sepBilby
#SBATCH --mail-user=sean.p.macbride@gmail.com
#SBATCH --mail-type=ALL
#SBATCH -A m1727
#SBATCH -t 5:0:0
#SBATCH --qos=regular
#SBATCH --nodes=1
#SBATCH --ntasks=256
#SBATCH --cpus-per-task=1
#SBATCH --constraint=cpu

# OpenMP settings:
export OMP_PROC_BIND=spread
export OMP_PLACES=threads
export OMP_NUM_THREADS=1
#SBATCH --cpu_bind=cores 

#SBATCH --output=/global/homes/s/seanmacb/DESC/DESC-GW/gwStreetlights/data/sepBilbyOuts/batch_0/slurm-${SLURM_JOBID}.out
# STDOUT

python /global/common/software/lsst/common/miniconda/start-kernel-cli.py desc-python

echo "Job ID"
echo $SLURM_JOBID
#run the application: 
for i in $(seq 0 255);
do
    python /global/homes/s/seanmacb/DESC/DESC-GW/gwStreetlights/CBCCats/SepBilbyBySNR.py -r $i &> "/global/homes/s/seanmacb/DESC/DESC-GW/gwStreetlights/data/sepBilbyOuts/batch_0/slurm-${SLURM_JOBID}_${i}.out" &
done
echo "Sleeping..."
sleep 5h
